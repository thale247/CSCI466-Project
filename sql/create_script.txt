USE z1986037;

DROP TABLE IF EXISTS Product_Order;
DROP TABLE IF EXISTS `Order`;
DROP TABLE IF EXISTS Contains;
DROP TABLE IF EXISTS Cart;
DROP TABLE IF EXISTS Shipping_Location;
DROP TABLE IF EXISTS User;
DROP TABLE IF EXISTS Product;

CREATE TABLE User (
Username VARCHAR(255) PRIMARY KEY,
Password VARCHAR(255) NOT NULL,
Email VARCHAR(255) NOT NULL,
First_Name VARCHAR(255) NOT NULL,
Last_Name VARCHAR(255) NOT NULL,
Is_Admin BOOL NOT NULL);

CREATE TABLE Cart (
Cart_Number INT PRIMARY KEY AUTO_INCREMENT,
Username VARCHAR(255) NOT NULL,
Cart_Total DECIMAL(10,2),
FOREIGN KEY (Username) REFERENCES User(Username));

CREATE TABLE Product (
Product_ID INT PRIMARY KEY AUTO_INCREMENT,
Name VARCHAR(255) NOT NULL,
Price DECIMAL(10,2) NOT NULL,
In_Stock INT NOT NULL,
Description VARCHAR(255));

CREATE TABLE Contains (
Cart_Number INT NOT NULL,
Product_ID INT NOT NULL,
Quantity INT NOT NULL,
PRIMARY KEY (Cart_Number, Product_ID),
FOREIGN KEY (Cart_Number) REFERENCES Cart(Cart_Number),
FOREIGN KEY (Product_ID) REFERENCES Product(Product_ID));

CREATE TABLE Shipping_Location(
Loc_ID INT PRIMARY KEY AUTO_INCREMENT,
Username VARCHAR(255) NOT NULL,
Shipping_Addr VARCHAR(255) NOT NULL,
Apt_Suite VARCHAR(255),
Zip INT NOT NULL,
City VARCHAR(255) NOT NULL,
State VARCHAR(255) NOT NULL,
FOREIGN KEY (Username) REFERENCES User(Username));

CREATE TABLE `Order` (
Order_Number INT PRIMARY KEY AUTO_INCREMENT,
Username VARCHAR(255) NOT NULL,
Loc_ID INT NOT NULL,
Order_Total DECIMAL(10,2),
Status VARCHAR(255),
Notes VARCHAR(255),
Tracking_Number VARCHAR(255),
Order_DateTime DATETIME NOT NULL,
FOREIGN KEY (Username) REFERENCES User(Username),
FOREIGN KEY (Loc_ID) REFERENCES Shipping_Location(Loc_ID));

CREATE TABLE Product_Order(
Product_ID INT,
Order_Number INT,
Quantity INT NOT NULL,
PRIMARY KEY (Product_ID, Order_Number),
FOREIGN KEY (Product_ID) REFERENCES Product(Product_ID),
FOREIGN KEY (Order_Number) REFERENCES `Order`(Order_Number));
